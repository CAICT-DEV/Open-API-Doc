## 6 资源数据共享

本接口定义了一个标准的资源数据开放方式，通过将资源数据作为公共数据开放到主链开放资源库，实现资源数据可以被星火·链网生态全体用户按需检索和在线交易。 骨干节点需具备调用该接口的功能，子链可按需将资源数据在主链进行开放、交易。资源数据上传至主链，其BID标识无自主交互需求时，无需为其生成主链BID。

### 6.1 数据资源上传

接口说明：

将子链资源数据上传至主链，便于后续托管、共享、开放等操作，限制大小为100M。

请求参数：

form表单格式

| **字段名**  | **类型** | **是否必填** | **描述**                   |
| :---------- | -------: | :----------- | :------------------------- |
| accessToken |   String | 是           | API令牌                    |
| file        |     file | 是           | 资源文件                   |
| name        |   String | 是           | 资源名称                   |
| industry    |   String | 是           | 行业类型**见10行业类型表** |
| encrypt     |   String | 是           | 0不加密,1加密              |
| ownerBid    |   String | 是           | 资源拥有人BID              |


返回数据：

| **字段名**  | **类型** | **描述**             |
| :---------- | :------- | :------------------- |
| resourceBid | String   | 资源bid              |
| errorCode   | int      | 错误码 0成功 非0失败 |
| message     | String   | 错误描述             |


示例：

（1）请求示例：

```plain
http请求方式：POST
https://{url}/v1/rdm/property/upload
{
    "accessToken": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJhcGlLZXkiOiJhdkNmcDdscU16SDVtTk5kIiwiaXNzIjoiQklGLUNIQUlOIiwiZXhwIjoxNjExNzQ0NjIwLCJiaWQiOiJkaWQ6YmlkOmVmejNvVFFHN0xZZktKRWlDeU1nNThOOVREZjl2cFd5In0.sCm7gaWX_nmIasUyo64tn5FeAqDaxxDn2Kb9Jixk2YI",
    "file":a.img,
    "name":"",
    "industry":"",
    "encrypt":"",
    "ownerBid":""
}
```

（2）返回结果示例：

a. 接口调用成功，则返回JSON数据示例为：

```plain
{
	"data":{
		"resourceBid":"did:bid:efhbk6Y1kF7SuuvT2389JExuQtUVEX4n"
	},
    "errorCode": 0,
    "message": "操作成功"
}
```

b. 接口调用失败，则返回JSON数据示例为：

```plain
{
    "errorCode": 940000,
    "message": "系统内部错误"
}
```

### 6.2 创建共享群组

接口说明：

创建一个共享的群组，每个群组可以设置多个账户，用户可将上传至主链的资源数据共享给该群组，实现资源数据的共享操作。

请求参数：

| **字段名** |     **类型** | **是否必填** | **描述**  |
| :--------- | -----------: | :----------- | :-------- |
| creatorBid |       String | 是           | 创建者BID |
| name       |       String | 是           | 群组名称  |
| memberList | List<String> | 是           | 群组成员  |


返回数据：

| **字段名** | **类型** | **描述** |
| :--------- | :------- | :------- |
| groupId    | Integer  | 群组id   |
| errorCode  | Integer  | 错误码   |
| message    | String   | 错误描述 |


示例：

（1）请求示例：

```plain
http请求方式：POST
https://{url}/v1/rdm/group/add
{
    "accessToken": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJhcGlLZXkiOiJhdkNmcDdscU16SDVtTk5kIiwiaXNzIjoiQklGLUNIQUlOIiwiZXhwIjoxNjExNzQ0NjIwLCJiaWQiOiJkaWQ6YmlkOmVmejNvVFFHN0xZZktKRWlDeU1nNThOOVREZjl2cFd5In0.sCm7gaWX_nmIasUyo64tn5FeAqDaxxDn2Kb9Jixk2YI",
    "params": {
        "name": "我的群组1",
        "creatorBid":"did:bid:efhbk6Y1kF7SuuvT2389JExuQtUVEX4n",
        "memberList": [
        	"did:bid:2Bsqo7DDFycSf7eNHdxUTCHZopZy4YC",
        	"did:bid:efhbk6Y1kF7SuuvT2389JExuQtUVEX4n"
        ]
    }
}
```

（2）返回结果示例：

a. 接口调用成功，则返回JSON数据示例为：

```plain
{
	"data": {
        "groupId": 11
    },
    "errorCode": 0,
    "message": "操作成功"
}
```

b. 接口调用失败，则返回JSON数据示例为：

```plain
{
    "errorCode": 940000,
    "message": "系统内部错误"
}
```

### 6.3 数据资源共享

接口说明：

将资源数据共享给群组，群组的相关人员可以查询数据资源。

请求参数：

| **字段名**  |      **类型** | **是否必填** | **描述**           |
| :---------- | ------------: | :----------- | :----------------- |
| ownerBid    |        String | 是           | 资源拥有人bid      |
| resourceBid |        String | 是           | 数据资源bid        |
| groupIds    | List<Integer> | 是           | 共享的目标群组列表 |


返回数据：

| **字段名** | **类型** | **描述** |
| :--------- | :------- | :------- |
| errorCode  | Integer  | 错误码   |
| message    | String   | 错误描述 |


示例：

（1）请求示例：

```plain
http请求方式：POST
https://{url}/v1/rdm/property/share
{
    "accessToken": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJhcGlLZXkiOiJhdkNmcDdscU16SDVtTk5kIiwiaXNzIjoiQklGLUNIQUlOIiwiZXhwIjoxNjExNzQ0NjIwLCJiaWQiOiJkaWQ6YmlkOmVmejNvVFFHN0xZZktKRWlDeU1nNThOOVREZjl2cFd5In0.sCm7gaWX_nmIasUyo64tn5FeAqDaxxDn2Kb9Jixk2YI",
    "params": {
        "ownerBid":"did:bid:ef97XGDXwY3VF6Pe6hkSPkawwQ4JJaHX",
        "resourceBid":"did:bid:efhbk6Y1kF7SuuvT2389JExuQtUVEX4n",
        "groupIds": [11]
    }
}
```

（2）返回结果示例：

a. 接口调用成功，则返回JSON数据示例为：

```plain
{
    "errorCode": 0,
    "message": "操作成功"
}
```

b. 接口调用失败，则返回JSON数据示例为：

```plain
{
    "errorCode": 940000,
    "message": "系统内部错误"
}
```

### 6.4 开放资源数据申请

接口说明：

将子链存证数据等公共资源数据同步至主链，在整个链网中开放共享，其他用户可以在主链的开放资源库上查看该资源数据，并有条件地下载。

请求参数：

| **字段名**  | **类型** | **是否必填** | **描述**                  |
| :---------- | -------: | :----------- | :------------------------ |
| ownerBid    |   String | 是           | 资源拥有人bid             |
| resourceBid |   String | 是           | 数据资源BID               |
| xhToken     |   String | 否           | 下载资源数据 所需星火积分 |


返回数据：

| **字段名** | **类型** | **描述**     |
| :--------- | :------- | :----------- |
| applyNo    | String   | 开放申请编号 |


示例：

（1）请求示例：

```plain
http请求方式：POST 
https://{url}/v1/rdm/open/resource
{
    "accessToken": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJhcGlLZXkiOiJhdkNmcDdscU16SDVtTk5kIiwiaXNzIjoiQklGLUNIQUlOIiwiZXhwIjoxNjExNzQ0NjIwLCJiaWQiOiJkaWQ6YmlkOmVmejNvVFFHN0xZZktKRWlDeU1nNThOOVREZjl2cFd5In0.sCm7gaWX_nmIasUyo64tn5FeAqDaxxDn2Kb9Jixk2YI",
    "params":{
      "ownerBid":"did:bid:ef97XGDXwY3VF6Pe6hkSPkawwQ4JJaHX",
      "resourceBid": "did:bid:efhbk6Y1kF7SuuvT2389JExuQtUVEX4n",
      "xhToken": "20"
    }   
}
```

（2）返回结果示例：

a. 接口调用成功，则返回JSON数据示例为：

```plain
{
    "data": {
        "applyNo": "d65811d227d8308f"
    },
    "errorCode": 0,
    "message": "操作成功"
}
```

b. 接口调用失败，则返回JSON数据示例为：

```plain
{
    "errorCode": 940000,
    "message": "系统内部错误"
}
```

### 6.5 查询开放资源申请状态

接口说明：

查询开放资源申请状态

请求参数：

| **字段名** | **类型** | **是否必填** | **描述** |
| :--------- | -------: | :----------- | :------- |
| applyNo    |   String | 是           | 申请编号 |


返回数据：

| **字段名**  | **类型** | **描述**                      |
| :---------- | :------- | :---------------------------- |
| auditStatus | String   | 0待审核 1审核通过 2审核不通过 |
| auditRemark | String   | 审核备注                      |


示例：

（1）请求示例：

```plain
http请求方式：POST 
https://{url}/v1/rdm/open/resource/status
{
    "accessToken": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJhcGlLZXkiOiJhdkNmcDdscU16SDVtTk5kIiwiaXNzIjoiQklGLUNIQUlOIiwiZXhwIjoxNjExNzQ0NjIwLCJiaWQiOiJkaWQ6YmlkOmVmejNvVFFHN0xZZktKRWlDeU1nNThOOVREZjl2cFd5In0.sCm7gaWX_nmIasUyo64tn5FeAqDaxxDn2Kb9Jixk2YI",
    "params":{
       "applyNo":""
    }
}
```

（2）返回结果示例：

a. 接口调用成功，则返回JSON数据示例为：

```plain
{
    "data": {
        "auditStatus": "1",
        "auditRemark": ""
    },
    "errorCode": 0,
    "message": "操作成功"
}
```

b. 接口调用失败，则返回JSON数据示例为：

```plain
{
    "errorCode": 940000,
    "message": "系统内部错误"
}
```
