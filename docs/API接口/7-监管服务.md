## 7 监管服务

骨干节点按监管节点的监管规则对其下属子链执行穿透式监管，并将监管报告周期性上报至监管节点。

### 7.1 违禁词查询

接口说明：

违禁词列表是由监管节点制定，骨干节点可通过该接口查询违禁字典列表信息，并在其骨干节点及其子链系统中按照违禁词列表要求执行筛查工作，避免违禁内容上链。

请求参数：

| **字段名** | **类型** | **是否必填** | **描述**           |
| :--------- | -------: | :----------- | :----------------- |
| pageStart  |  Integer | 是           | 开始页 默认1       |
| pageSize   |  Integer | 是           | 每页条数 默认100条 |

返回数据：

| 字段名                  | 类型    | 描述          |
| :---------------------- | :------ | :------------ |
| forbiddenWords.bid      | string  | 违禁词文件bid |
| forbiddenWords.fileName | string  | 文件名称      |
| forbiddenWords.fileSize | string  | 文件大小      |
| forbiddenWords.hash     | string  | 文件hash      |
| forbiddenWords.showUrl  | string  | 下载链接      |
| forbiddenWords.time     | string  | 时间戳        |
| page                    | Object  | 分页对象      |
| page.pageSize           | Integer | 每页条数      |
| page.pageStart          | Integer | 开始页        |
| page.pageTotal          | Integer | 总页数        |

示例：

（1）请求示例：

```plain
http请求方式：POST
https://{url}/v1/sam/forbiddenWords/list
{
"accessToken":"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJhcGlLZXkiOiJhdkNmcDdscU16SDVtTk5kIiwiaXNzIjoiQklGLUNIQUlOIiwiZXhwIjoxNjExNzQ0NjIwLCJiaWQiOiJkaWQ6YmlkOmVmejNvVFFHN0xZZktKRWlDeU1nNThOOVREZjl2cFd5In0.sCm7gaWX_nmIasUyo64tn5FeAqDaxxDn2Kb9Jixk2YI",
 "params":{
 		"pageStart":1,
 		"pageSize":"10"
 }
}
```

（2）返回结果示例：

a. 接口调用成功，则返回JSON数据示例为：

```plain
{
  "errorCode": 0,
  "message": "操作成功",
  "data": {
   "page": {
      "pageSize": 10,
      "pageStart": 1,
      "pageTotal": 1
    },
    "forbiddenWords": [
      {
        "bid": "did:bid:ef28p1tiudukKhrm55uLXYYEAz8aSSykc",
        "fileName": "建筑业",
        "fileSize": 351543,
        "hash": "QmdPQcsYwswHTDBsvcdFhHAkyZujpcJcNEsHCJ3BwqaV88",
        "showUrl": "/oss/file/get/QmdPQcsYwswHTDBsvcdFhHAkyZujpcJcNEsHCJ3BwqaV88",
        "time": "1614838039000"
      }
    ]
  }
}

```

b. 接口调用失败，则返回JSON数据示例为：

```plain
{
    "errorCode": 940000,
    "message": "系统内部错误"
}
```

### 7.2 监管报告

骨干节点向监管节点周期性同步监管报告

请求参数：

| 字段名     | 类型   | 是否必填 | 描述                        |
| ---------- | ------ | -------- | --------------------------- |
| chainCode  | String | 是       | AC号                        |
| reportTime | Long   | 是       | 报告时间（时间戳 单位毫秒） |
| fileName   | String | 是       | 文件名                      |
| fileSize   | String | 是       | 文件大小                    |
| hash       | String | 是       | 文件存储的hash              |
| showUrl    | String | 是       | 获取文件的链接              |


返回数据：

| 字段名    | 类型   | 描述    |
| :-------- | :----- | :------ |
| reportBid | string | 报告BID |


示例：

（1）请求示例：

```plain
http请求方式：POST
https://{url}/v1/sam/report/syn
{

"accessToken":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhcHBJZCI6IkZDMjFnN2JzMVI2TjJGWjMiLCJpc3MiOiJidW1vIiwiZXhwIjoxNTYxMDAyODIyfQ.hgVH0T6fLxk973U2fIj_ejDx5aJuzRFlg1VAUA2RgzM",
  "params":{
  		"chainCode":"",
			"reportTime":"",
			"fileName":"",
			"fileSize":"",
			"hash":"",
			"showUrl":""
  }
}
```

（2）返回结果示例：

a. 接口调用成功，则返回JSON数据示例为：

```plain
{
  "errorCode": 0,
  "message": "操作成功",
  "data": {
    "reportBid":""
  }
}

```

b. 接口调用失败，则返回JSON数据示例为：

```plain
{
    "errorCode": 940000,
    "message": "系统内部错误"
}
```

### 7.3 查询工单列表(暂缓开通)

骨干节点可通过该接口在询监管节点查询跟其相关的工单列表。

请求参数：

| **字段名** | **类型** | **是否必填** | **描述**           |
| :--------- | :------- | :----------- | :----------------- |
| pageStart  | Integer  | 是           | 开始页 默认1       |
| pageSize   | Integer  | 是           | 每页条数 默认100条 |


返回数据：

| **字段名**                  | **类型** | **描述**                                             |
| :-------------------------- | :------- | :--------------------------------------------------- |
| workOrderList               | List     | 工单列表                                             |
| workOrderList.workOrderBid  | String   | 工单BID                                              |
| workOrderList.workOrderType | String   | 工单类型（1合约违规、2大额交易、3违禁词违规、4其他） |
| workOrderList.title         | String   | 工单标题                                             |
| workOrderList.subjectBid    | String   | 违规主体BID                                          |
| workOrderList.remark        | String   | 工单备注                                             |
| workOrderList.createTime    | Long     | 工单创建时间                                         |
| workOrderList.files         | String   | 附件下载地址                                         |
| Page                        | Object   | 分页对象                                             |
| page.pageSize               | Integer  | 每页条数                                             |
| page.pageStart              | Integer  | 开始页                                               |
| page.pageTotal              | Integer  | 总页数                                               |

示例：

（1）请求示例：

```plain
http请求方式：POST
https://{url}/v1/sam/order/list
{
  "accessToken":"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJhcGlLZXkiOiJhdkNmcDdscU16SDVtTk5kIiwiaXNzIjoiQklGLUNIQUlOIiwiZXhwIjoxNjExNzQ0NjIwLCJiaWQiOiJkaWQ6YmlkOmVmejNvVFFHN0xZZktKRWlDeU1nNThOOVREZjl2cFd5In0.sCm7gaWX_nmIasUyo64tn5FeAqDaxxDn2Kb9Jixk2YI",
  "params":{
      "pageStart":1,
      "pageSize":10
  }
}
```

（2）返回结果示例：

a. 接口调用成功，则返回JSON数据示例为：

```plain
{
    "errorCode": 0,
    "message": "操作成功",
    "data": {
        "workOrderList": [{
            "workOrderBid": "",
            "workOrderType": "1",
            "chainCode": "by01",
            "title": "",
            "subjecBid": "",
            "crateTime": 1627550601505,
            "remark": ""
        }],
        "page": {
            "pageSize": 100,
            "pageStart": 1,
            "pageTotal": 1
        }
    }
}
```

b. 接口调用失败，则返回JSON数据示例为：

```plain
{
    "errorCode": 940000,
    "message": "系统内部错误"
}
```

### 7.4 工单处理反馈(暂缓开通)

星火·链网中违法违规事件通过工单的形式体现，骨干节点需要按照工单规范将违法违规事件同步给监管节点，便于审查。（骨干节点有工单处理需实时同步给监管节点）

请求参数：

| **字段名**     | **类型** | **是否必填** | **描述**                                                   |
| :------------- | :------- | :----------- | :--------------------------------------------------------- |
| chainCode      | String   | 是           | AC号                                                       |
| workOrderBid   | String   | 是           | 工单BID                                                    |
| subjectBid     | String   | 否           | 主体bid(处置方式为忽略，此参数不传)                        |
| subjectType    | String   | 否           | 主体类型 1业务节点 2企业 3 合约处置方法为忽略，此参数不传) |
| disposalMethod | String   | 是           | 处置方式（0忽略 1启用 2停用 ）                             |
| status         | String   | 是           | 工单状态（2已处置 3已忽略）                                |
| remarks        | String   | 否           | 处置备注                                                   |


返回数据：

| **字段名** | **类型** | **描述**                       |
| :--------- | :------- | :----------------------------- |
| bid        | String   | 处置记录Bid(忽略时 该值不返回) |


示例：

（1）请求示例：

```plain
http请求方式：POST
https://{url}/v1/sam/order/syn
{
  "accessToken": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJhcGlLZXkiOiJhdkNmcDdscU16SDVtTk5kIiwiaXNzIjoiQklGLUNIQUlOIiwiZXhwIjoxNjExNzQ0NjIwLCJiaWQiOiJkaWQ6YmlkOmVmejNvVFFHN0xZZktKRWlDeU1nNThOOVREZjl2cFd5In0.sCm7gaWX_nmIasUyo64tn5FeAqDaxxDn2Kb9Jixk2YI",
   "params": {
        "chainCode": "by01",
        "workOrderBid":"did:bid:efRiWFH15Kv8sHH4iurnKA8V9VZan2VW",
        "subjectBid": "did:bid:ef28pM9MG3TGXGyWAW4JpWCFsJDd5MBnc",
        "subjectType": "1",
        "disposalMethod": "1",
        "remarks": "1",
        "status": "2"
    }
}
```

（2）返回结果示例：

a. 接口调用成功，则返回JSON数据示例为：

```plain
{
    "errorCode": 0,
    "message": "操作成功"
}
```

b. 接口调用失败，则返回JSON数据示例为：

```plain
{
    "errorCode": 940000,
    "message": "系统内部错误"
}
```
