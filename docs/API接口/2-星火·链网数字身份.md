## 2 星火·链网数字身份

星火·链网数字身份内容包括BID标识及标识对象属性信息（如企业信息、个人信息、智能设备信息等）、公私钥管理、凭证信息等，适用于标识对象需要自主控制私钥的应用场景。

### 2.1 生成主链数字身份

接口说明：

子链用户在子链自生成星火·链网子链数字身份后，需要获取主链数字身份才能使用主链或其他子链的服务。因此，骨干节点需具备调用数字身份接口的功能，子链可根据具体业务，有选择地为用户获取主链数字身份。bid的生成规则请见13节bid数字身份生成算法。

请求参数：

|**字段名**|**类型**|**是否必填**|**描述**|
|:----|----:|:----|:----|
|bid|String(64)|是|账户子链数字身份BID|
|type|String(4)|是|数字身份类型： 101人、102企业、103节点 、104智能设备、105智能合约|
|publicKey|String(128)|是|数字身份公钥|


返回数据：

|**字段名**|**类型**|**描述**|
|:----|:----|:----|
|bid|String|主链数字身份BID|
|txHash|String|链上交易hash|
|errorCode|int|0|
|message|String|成功|


示例：

（1）请求示例：

```plain
http请求方式：POST
https://{url}/v1/bid/identity/generate
{
 "accessToken":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhcHBJZCI6IkZDMjFnN2JzMVI2TjJGWjMiLCJpc3MiOiJidW1vIiwiZXhwIjoxNTYxMDAyODIyfQ.hgVH0T6fLxk973U2fIj_ejDx5aJuzRFlg1VAUA2RgzM",
  "params":{
    "bid":"did:bid:by01:efhbk6Y1kF7SuuvT2389JExuQtUVEX4n",
    "type":"101",
    "publicKey":""
  }
}
```
（2）返回结果示例：

a. 接口调用成功，则返回JSON数据示例为：

```plain
{
    "data":{
      "bid":"did:bid:efhbk6Y1kF7SuuvT2389JExuQtUVEX4n",
      "txHash":"aa87a25080fa03cdd5ea51fb06440646b9dde93319ff403f2bf095c8b5edff47"
    },
    "errorCode": 0,
    "message": "操作成功"
}
```
b. 接口调用失败，则返回JSON数据示例为：

```plain
{
    "errorCode": 940000,
    "message": "系统内部异常"
}
```
### 2.2 可信认证申请

#### 2.2.1上传图片

接口说明：

可信认证需要上传企业营业执照、法人身份证等图片。只用于数字身份上传使用，图片格式要求为PNG、BMP、JPG或GIF，单张照片大小不超过2M。

请求参数：

form表单格式

| **字段名**  | **类型** | **是否必填** | **描述** |
| :---------- | -------: | :----------- | :------- |
| accessToken |   String | 是           | API令牌  |
| file        |     file | 是           | 图片     |


返回数据：

| **字段名** | **类型** | **描述**             |
| :--------- | :------- | :------------------- |
| filePath   | String   | 文件路径             |
| errorCode  | int      | 错误码 0成功 非0失败 |
| message    | String   | 错误描述             |


示例：

（1）请求示例：

```plain
http请求方式：POST
https://{url}/v1/bid/id-info-bin/upload
{
  "accessToken":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhcHBJZCI6IkZDMjFnN2JzMVI2TjJGWjMiLCJpc3MiOiJidW1vIiwiZXhwIjoxNTYxMDAyODIyfQ.hgVH0T6fLxk973U2fIj_ejDx5aJuzRFlg1VAUA2RgzM",
  "file":a.img
}
```

（2）返回结果示例：

a. 接口调用成功，则返回JSON数据示例为：

```plain
{
    "data":{
     "filePath":"/oss/file/get/QmV1Z7syFkw8Tg41RuWChn7Ad3KjwgTexHeJ2LiYEEK2rd"
    },
    "errorCode": 0,
    "message": "成功"
}
```

b. 接口调用失败，则返回JSON数据示例为：

```plain
{
    "errorCode": 940000,
    "message": "成功"
}
```

#### 2.2.2 企业可信认证申请

接口说明：

企业获取主链数字身份后，可通过接口进行可信认证

请求参数：

| **字段名**              | **类型** | **是否必填** | **描述**                                             |
| :---------------------- | -------: | :----------- | :--------------------------------------------------- |
| userBid                 |   String | 是           | 用户bid                                              |
| companyName             |   String | 是           | 企业全称                                             |
| companyShortName        |   String | 是           | 企业简称                                             |
| companyIntroduce        |   String | 是           | 企业简介                                             |
| companyIndustry         |   String | 是           | 所属行业                                             |
| companyProperty         |   String | 是           | 企业性质(0国有企业、1私有企业、2事业单位 3国家行政)  |
| registeredAddressDetail |   String | 是           | 企业注册地址                                         |
| qualifieProve           |   String | 是           | 资质证明类型（默认 见10证件类型表 ）                 |
| qualifieNumber          |   String | 是           | 资质号码                                             |
| qualifieValidateStart   |   String | 是           | 资质有效期（开始）                                   |
| qualifieValidateEnd     |   String | 是           | 资质有效期（结束）                                   |
| qualifiePic             |   String | 是           | 资质照片（需要填写1.2.1接口返回的文件路径 filePath） |
| legalPersonName         |   String | 是           | 法人名称                                             |
| legalIdType             |   String | 是           | 法人证件类类型（见9证件类型表）                      |
| legalIdNumber           |   Object | 是           | 证件号码                                             |
| legalIdValidateStart    |   String | 是           | 证件有效期(开始)                                     |
| legalIdValidateEnd      |   String | 是           | 证件有效期(结束)                                     |
| legalIdPic              |   String | 是           | 证件正面（需要填写2.2.1接口返回的文件路径 filePath)  |
| legalIdBackPic          |   String | 是           | 证件背面（需要填写2.2.1接口返回的文件路径 filePath)  |
| linkmanName             |   String | 是           | 联系人名称                                           |
| linkmanPhone            |   String | 是           | 手机号                                               |
| linkmanEmail            |   String | 是           | 邮箱                                                 |
| linkmanAuthCert         |   Object | 是           | 授权书（需要填写1.2接口返回的文件路径 filePath)      |


返回数据：

| **字段名** | **类型** | **描述** |
| :--------- | :------- | :------- |
| applyNo    | String   | 申请编号 |


示例：

（1）请求示例：

```plain
http请求方式：POST
https://{url}/v1/bid/company/credential/apply
{
  "accessToken": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJhcGlLZXkiOiJqQ3h0eVJBayIsImlzcyI6IkJJRi1DSEFJTiIsImV4cCI6MTYwOTM4NzkxMiwiYmlkIjoiZGlkOmJpZDplZnozb1RRRzdMWWZLSkVpQ3lNZzU4TjlURGY5dnBXeSJ9.YHAsE6fiuFBISWeS06HpJr-GBfMTDCuekbZ-WTK1BjE",
  "params": {
	"companyName": "美团",
	"companyShortName": "美团",
	"companyIntroduce": "1",
	"companyIndustry": "A",
	"companyProperty": "0",
	"registeredAddressDetail": "河南省洛阳市新安县",
	"qualifieProve": "8",
	"qualifieNumber": "111111111111111",
	"qualifieValidateStart": "2021-07-26",
	"qualifieValidateEnd": "2021-08-12",
	"qualifiePic": "/oss/file/get/QmV1Z7syFkw8Tg41RuWChn7Ad3KjwgTexHeJ2LiYEEK2rd",
	"legalPersonName": "王兴",
	"legalIdType": "1",
	"legalIdNumber": "142766199701031224",
	"legalIdValidateStart": "2021-06-28",
	"legalIdValidateEnd": "2021-07-08",
	"legalIdPic": "/oss/file/get/QmV1Z7syFkw8Tg41RuWChn7Ad3KjwgTexHeJ2LiYEEK2rd",
	"legalIdBackPic": "/oss/file/get/QmV1Z7syFkw8Tg41RuWChn7Ad3KjwgTexHeJ2LiYEEK2rd",
	"linkmanName": "zzz",
	"linkmanPhone": "15833333333",
	"linkmanEmail": "9@qq.com",
	"linkmanAuthCert": "/oss/file/get/QmV1Z7syFkw8Tg41RuWChn7Ad3KjwgTexHeJ2LiYEEK2rd"
	}
}
```

（2）返回结果示例：

a. 接口调用成功，则返回JSON数据示例为：

```plain
{
  "errorCode": 0,
  "message": "操作成功",
  "data": {
     applyNo:""
  }
}
```

b. 接口调用失败，则返回JSON数据示例为：

```plain
{
    "errorCode": 940026,
    "message": "认证已申请完成或申请中"
}
```

#### 2.2.3 个人可信认证申请

接口说明：

个人获取主链数字身份后，可通过接口进行可信认证，

请求参数：

| **字段名**    | **类型** | **是否必填** | **描述**                                               |
| :------------ | -------: | :----------- | :----------------------------------------------------- |
| userBid       |   String | 是           | 用户bid                                                |
| realName      |   String | 是           | 真实名称                                               |
| idType        |   String | 是           | 证件类型                                               |
| idNumber      |   String | 是           | 证件号                                                 |
| validateStart |   String | 是           | 证件有效期（开始）                                     |
| validateEnd   |   String | 是           | 证件有效期（结束）                                     |
| idPic         |   String | 是           | 证件照片（需要填写2.2.1接口返回的文件路径 filePath）   |
| idBackPic     |   String | 是           | 证件背面（需要填写2.2.1接口返回的文件路径 filePath）   |
| idHandPic     |   String | 是           | 手持证件照（需要填写2.2.1接口返回的文件路径 filePath） |


返回数据：

| 字段名  | String | 交易hash |
| :------ | :----- | :------- |
| applyNo | String | 申请编号 |


示例：

（1）请求示例：

```plain
http请求方式：POST
https://{url}/v1/bid/person/credential/apply
{
  "accessToken": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJhcGlLZXkiOiJqQ3h0eVJBayIsImlzcyI6IkJJRi1DSEFJTiIsImV4cCI6MTYwOTM4NzkxMiwiYmlkIjoiZGlkOmJpZDplZnozb1RRRzdMWWZLSkVpQ3lNZzU4TjlURGY5dnBXeSJ9.YHAsE6fiuFBISWeS06HpJr-GBfMTDCuekbZ-WTK1BjE",
  "params": {
	"idType": "1",
	"idBackPic": "/oss/file/get/QmeCBcxCrTZDKK1m2BbqMxUWeSovJ7XwhY8MHWHdBdFBN6",
	"idHandPic": "/oss/file/get/Qmd1d4CNbrhXbRuDcJdHodYBZtNHmVDYH6Mfxo7aD1pwTA",
	"idNumber": "520181199405272642",
	"realName": "晓鹏",
	"idPic": "/oss/file/get/QmRkNfCvJEsQyjTLw7v9Nmgx1sY7xePhHpDJJTKoLdokME",
	"validateEnd": "2040-07-03",
	"validateStart": "2020-11-03"
}
}
```

（2）返回结果示例：

a. 接口调用成功，则返回JSON数据示例为：

```plain
{
  "errorCode": 0,
  "message": "操作成功",
  "data": {
     applyNo:""
  }
}
```

b. 接口调用失败，则返回JSON数据示例为：

```plain
{
    "errorCode": 940026,
    "message": "认证已申请完成或申请中"
}
```

### 2.3 查询可信认证申请结果

接口说明：

查询可信认证结果，用于可信认证校验。

请求参数：

| **字段名** | **类型** | **是否必填** | **描述**            |
| :--------- | -------: | :----------- | :------------------ |
| bid        |   String | 是           | 用户主链数字身份BID |


返回数据：

| **字段名**  | **类型** | **描述**                              |
| :---------- | :------- | :------------------------------------ |
| applyStatus | String   | 0未申请 1待审核 2审核通过 3审核不通过 |


示例：

（1）请求示例：

```plain
http请求方式：POST
https://{url}/v1/bid/auth/trusted
{
  "accessToken":"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJhcGlLZXkiOiJhdkNmcDdscU16SDVtTk5kIiwiaXNzIjoiQklGLUNIQUlOIiwiZXhwIjoxNjExNzQ0NjIwLCJiaWQiOiJkaWQ6YmlkOmVmejNvVFFHN0xZZktKRWlDeU1nNThOOVREZjl2cFd5In0.sCm7gaWX_nmIasUyo64tn5FeAqDaxxDn2Kb9Jixk2YI",
  "params":{
    "bid":"did:bid:efNY98KmDLXQFvJuJEtMUvFX3fTEvxVS"
  }
}
```

（2）返回结果示例：

a. 接口调用成功，则返回JSON数据示例为：

```plain
{
    "errorCode": 0,
    "message": "操作成功",
    "data": {
        "applyStatus":"1"
    }
}
```

b. 接口调用失败，则返回JSON数据示例为：

```plain
{
    "errorCode": 940000,
    "message": "系统内部错误"
}
```

### 2.4 凭证创建（暂缓开通）

接口说明：

用户通过该接口可以创建凭证，凭证创建完成后，在星火·链网管理平台审核通过后，其他用户可以申请该凭证

请求参数：

| **字段名** | **类型** | **是否必填** | **描述**                    |
| ---------- | -------: | ------------ | --------------------------- |
| userBid    |   String | 是           | 用户BID(凭证创建人)         |
| name       |   string | 是           | 凭证名字                    |
| industryId |  Integer | 是           | 所属行业Id                  |
| categoryId |  Integer | 是           | 所属分类Id                  |
| version    |   string | 是           | 凭证版本                    |
| remark     |   string | 否           | 凭证备注                    |
| data       |   string | 是           | 元数据和审核数据            |
| userType   |   string | 是           | 面向用户类型 1-个人，2-企业 |


返回数据：

| **字段名**         | **类型** | **描述**         |
| :----------------- | :------- | :--------------- |
| applyNo            | String   | 凭证创建申请编号 |
| voucherTemplateBid | String   | 凭证模版BID      |


示例：

（1）请求示例：

```plain
http请求方式：POST
https://{url}/v1/bid/voucher/create
{
  "accessToken": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJhcGlLZXkiOiJqQ3h0eVJBayIsImlzcyI6IkJJRi1DSEFJTiIsImV4cCI6MTYwOTM4NzkxMiwiYmlkIjoiZGlkOmJpZDplZnozb1RRRzdMWWZLSkVpQ3lNZzU4TjlURGY5dnBXeSJ9.YHAsE6fiuFBISWeS06HpJr-GBfMTDCuekbZ-WTK1BjE",
  "params":{
      "userBid":"",
      "name":"",
      "industryId":"",
      "categoryId":"",
      "version":"",
      "remark":"",
      "data":"",
      "userType":""
	}
}
```

（2）返回结果示例：

a. 接口调用成功，则返回JSON数据示例为：

```plain
{
  "errorCode": 0,
  "message": "操作成功",
  "data": {
  	"voucherBid":"",
     "applyNo":""
  }
}
```

b. 接口调用失败，则返回JSON数据示例为：

```plain
{
    "errorCode": 940000,
    "message": "系统内部错误"
}
```

### 2.5 凭证申请（暂缓开通）

接口说明：

用户通过该接口可以申请凭证

请求参数说明：

| **字段名**         | **类型** | **是否必填** | **描述**                       |
| ------------------ | -------: | ------------ | ------------------------------ |
| userBid            |   String | 是           | 用户BID（凭证申请人）          |
| content            |   String | 是           | 申请内容(凭证模版生成json数据) |
| voucherTemplateBid |   String | 是           | 凭证模版bid                    |

返回数据：

| **字段名** | **类型** | **描述** |
| :--------- | :------- | :------- |
| applyNo    | String   | 申请编号 |


示例：

（1）请求示例：

```plain
http请求方式：POST
https://{url}/v1/bid/voucher/apply
{
  "accessToken": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJhcGlLZXkiOiJqQ3h0eVJBayIsImlzcyI6IkJJRi1DSEFJTiIsImV4cCI6MTYwOTM4NzkxMiwiYmlkIjoiZGlkOmJpZDplZnozb1RRRzdMWWZLSkVpQ3lNZzU4TjlURGY5dnBXeSJ9.YHAsE6fiuFBISWeS06HpJr-GBfMTDCuekbZ-WTK1BjE",
  "params":{
  		"userBid":"",
      "content":"",
      "voucherTemplateBid":""
	}
}
```

（2）返回结果示例：

a. 接口调用成功，则返回JSON数据示例为：

```plain
{
  "errorCode": 0,
  "message": "操作成功",
  "data": {
     applyNo:""
  }
}
```

b. 接口调用失败，则返回JSON数据示例为：

```plain
{
    "errorCode": 940000,
    "message": "系统内部错误"
}
```
